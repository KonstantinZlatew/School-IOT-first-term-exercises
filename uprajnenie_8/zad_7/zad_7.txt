1) Избор на топология на захранването

Отговор: Топология: “Direct battery + storage capacitor” (без DC-DC), евентуално LDO само при нужда.

Обяснение:

DC-DC конвертор (buck/boost) добавя: собствен ток (IQ), бобина и повече компоненти, което е проблем при 10x10 mm 
и 1 µA sleep.

LDO също има IQ, но може да е много нисък; пак често не е нужен, защото MCU/радио обикновено работят в диапазон 
около 1.8–3.6 V.

Най-ефективно за “smart dust” е да се проектира системата да работи директно от напрежението на батерията, и да 
се стабилизира само най-чувствителното (ако изобщо).

Практически избор:

Отговор:

Ако MCU+радио работят от 2.0–3.6 V: директно от CR2032 без регулатор.

Ако имаш сензор, който иска точно 1.8 V или 2.5 V: ultra-low-IQ LDO само за него, включван през GPIO/MOSFET 
само когато се измерва.

Обяснение:
Най-големият “убиец” на батерията тук е IQ на регулатор/конвертор. При 5 години целеви живот, постоянен IQ дори 
2–3 µA вече е сериозен процент.


2) Схема с минимален брой компоненти

Отговор: Минимална схема (реалистична за 10x10 mm):

CR2032 → VDD шина

1× “bulk” кондензатор близо до радиото (например 47–220 µF, low leakage)

1× 100 nF керамичен кондензатор близо до MCU

Опционално: series resistor/NTC не е нужен; вместо това ако има риск от проседане – добавяш supercap или 
тантал/полимер с нисък leakage

Обяснение:
Bulk кондензаторът доставя импулсния ток при TX, а батерията “пълни” кондензатора между импулсите. Така 
напрежението върху батерията не пада рязко.

Ако трябва контрол на включването на товара:

Отговор: Добавяш 1 малък P-MOSFET (load switch) за радио блока, за да е напълно изключен в sleep.

Обяснение:
Много радиа имат leakage/standby, който е по-голям от 1 µA. Истинският “smart dust” трик е да режеш захранването 
на всичко, което не трябва да спи.


3) Оценка на живота на батерията

Трябва да знаем период на цикъла. Не е даден, затова ще дам обща формула и ще покажа пример с “един цикъл на 5 
минути” (като предишните задачи), за да имаш числен резултат.

3.1 Среден ток (формула)

Нека периодът е T секунди.
Имаме:

Сън: 1 µA за (T − 1 s − 0.01 s)

Измерване: 100 µA за 1 s

Предаване: 10 mA за 0.01 s

Заряд за един цикъл (в µA·s):

Отговор:
Q = 1·(T − 1.01) + 100·1 + 10000·0.01
Q = (T − 1.01) + 100 + 100
Q = T + 198.99 (µA·s)

Среден ток:

Отговор:
Iavg = Q / T = (T + 198.99) / T = 1 + (198.99 / T) (µA)

Обяснение:
Колкото по-рядко правиш измерване/предаване (по-голям T), толкова по-близо Iavg става до 1 µA.

3.2 Пример: цикъл на всеки 5 минути (T = 300 s)

Отговор:
Iavg = 1 + 198.99/300 = 1 + 0.6633 = 1.663 µA

Живот (часове) ≈ Capacity / Iavg
Capacity = 220 mAh = 220000 µAh

Life_hours = 220000 / 1.663 ≈ 132,300 h
Life_days = 132,300 / 24 ≈ 5,512 дни
Life_years = 5,512 / 365 ≈ 15.1 години

Обяснение:
Теоретично излиза над 5 години. На практика CR2032 ще даде по-малко заради саморазряд и спад на капацитета 
при импулсни токове и ниски температури.

3.3 Какво трябва, за да е 5 години

5 години = 5 · 365 · 24 = 43,800 h
Допустим среден ток:

Отговор:
Iavg,max = 220000 µAh / 43800 h ≈ 5.02 µA

Обяснение:
Тоест трябва средният ток да е под ~5 µA. Нашият пример (1.66 µA) е под тази граница, което е добре.


4) Реални проблеми и подобрения
Проблем 1: CR2032 и импулси 10 mA

Отговор: Най-големият риск е проседането на напрежението при 10 mA TX импулс.

Обяснение: CR2032 има сравнително високо вътрешно съпротивление; при импулс напрежението може да падне под 
минималното за радиото/MCU и да ресетне системата.

Подобрение:

Отговор: Добави буферен кондензатор (например 100–220 µF) с много нисък leakage и го постави максимално близо 
до радиото.

Обяснение: Кондензаторът доставя пиковия ток, батерията го дозарежда между импулсите.

Груба проверка за капацитет при TX:
Ако искаш спад не повече от 0.2 V по време на 10 ms при 10 mA:

Отговор:
C ≥ I·Δt/ΔV = 0.01 A · 0.01 s / 0.2 V = 0.0005 F = 500 µF

Обяснение:
Това показва, че за много малък droop може да ти трябва голям капацитет. На практика се разчита и на 
батерията да даде част от тока, и се допуска по-голям droop, но е важно да имаш “bulk”.

Проблем 2: Саморазряд и стареене

Отговор: Реалният лимит за 5+ години често не е само консумацията, а саморазрядът и стареенето на клетката.

Обяснение: Дори при идеална електроника, батерията губи капацитет с времето.